<!DOCTYPE html>
<html>
<head>
<title>Institutional Quant Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
background: black;
color: #00ffcc;
font-family: Consolas;
}

.container {
width: 95%;
margin: auto;
}

.card {
border: 1px solid #00ffcc;
padding: 15px;
margin: 10px;
}

.grid {
display: grid;
grid-template-columns: 1fr 1fr;
}

</style>
</head>

<body>

<div class="container">

<h1>üèõ Institutional Control Dashboard</h1>

<div class="grid">

<div class="card">
Mode: <span id="mode"></span><br>
Equity: ‚Çπ<span id="equity"></span><br>
PNL: ‚Çπ<span id="pnl"></span><br>
Trades: <span id="trades"></span><br>
Winrate: <span id="winrate"></span>%<br>
Strategy: <span id="strategy"></span><br>
</div>

<div class="card">
<canvas id="equityChart"></canvas>
</div>

<div class="card">
<canvas id="pnlChart"></canvas>
</div>

<div class="card">
<h3>Strategy Leaderboard</h3>
<div id="leaderboard"></div>
</div>

</div>

</div>

<script>

let equityChart = new Chart(
document.getElementById("equityChart"),
{
type: "line",
data: {
labels: [],
datasets: [{
label: "Equity",
data: [],
borderColor: "#00ffcc"
}]
}
}
)

let pnlChart = new Chart(
document.getElementById("pnlChart"),
{
type: "line",
data: {
labels: [],
datasets: [{
label: "PNL",
data: [],
borderColor: "#ffaa00"
}]
}
}
)

async function updateDashboard(){

let res = await fetch("/api/state")
let data = await res.json()

document.getElementById("mode").innerText = data.mode
document.getElementById("equity").innerText = data.equity
document.getElementById("pnl").innerText = data.pnl
document.getElementById("trades").innerText = data.trades
document.getElementById("winrate").innerText = data.winrate
document.getElementById("strategy").innerText = data.active_strategy

equityChart.data.labels = data.equity_curve.map((_,i)=>i)
equityChart.data.datasets[0].data = data.equity_curve
equityChart.update()

pnlChart.data.labels = data.pnl_curve.map((_,i)=>i)
pnlChart.data.datasets[0].data = data.pnl_curve
pnlChart.update()

let board = document.getElementById("leaderboard")
board.innerHTML=""

for (let s in data.strategies){
board.innerHTML += s + " : " + data.strategies[s] + "<br>"
}

}

setInterval(updateDashboard,1000)

</script>

</body>
</html>
